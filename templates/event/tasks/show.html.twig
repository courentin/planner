{% extends 'event/tasks/base.html.twig' %}

{% block event_container_tools %}
    <a href="{{ path('event_tasks_edit', {id: event.id, task_id: task.id}) }}" class="btn mb-3 btn-sm btn-primary"><i class="fa fa-magic mr-2"></i>Plannifier la tâche</a>
    <a href="{{ path('event_tasks_edit', {id: event.id, task_id: task.id}) }}" class="btn mb-3 btn-sm btn-primary"><i class="fa fa-pencil-alt mr-2"></i>Configurer </a>
    <a href="{{ path('event_tasks_edit', {id: event.id, task_id: task.id}) }}" class="btn mb-3 btn-sm btn-danger"><i class="fa fa-trash mr-2"></i>Supprimer</a>
{% endblock %}

{% block tasks_container %}
    <h3><i class="fa fa-circle fa-sm mr-2" style="color: {{ task.color }}"></i>{{ task.name }}</h3>
    <small class="text-muted d-block"><i class="fa fa-map-marker-alt mr-1"></i>{{ task.location }}</small>
    <p class="mt-3">{{ task.description }}</p>
    <hr/>
    <h4>Profil de la tâche</h4>
    <small class="text-muted d-block mb-3">Représente par tranches horaires : le nombre de ressources requises en rouge, le nombre de ressources effectives en bleu.</small>
    <div class="ct-chart"></div>
    {% if task.minWorkingTime is not null and task.maxWorkingTime is not null %}
        La tâche est ségmentée par tranche de {{ task.minWorkingTime|date('G\\hi') }} à {{ task.maxWorkingTime|date('G\\hi') }}
    {% endif %}
    <h4 class="mt-4">Compétences requises</h4>
    {% if task.skills|length %}
    <small class="text-muted d-block mb-3">Seuls les ressources appartenant à ces groupes peuvent effectuer cette tâche.</small>
    {% endif %}
    {% for skill in task.skills %}
        <a href="{{ path('event_skills_show', {id: event.id, skill_id: skill.id}) }}" class="badge badge-info badge-pill">{{ skill.name }}</a>
    {% else %}
        <div class="mt-3 alert alert-info d-flex justify-content-between align-items-center">
            <i class="fa fa-question-circle fa-2x mr-3"></i>
            <p class="mb-0"><span style="font-weight: bold">Aucune restriction sur les compétences pour cette tâche.</span> Toutes les ressources sont affectable à ce type de tâche.</p>
        </div>
    {% endfor %}
    {% if notEnoughResources is defined and notEnoughResources %}
    <div class="mt-3 alert alert-warning d-flex justify-content-between align-items-center">
        <i class="fa fa-exclamation-circle fa-2x mr-3"></i>
        <div>
            <p class="mb-1">
                <span style="font-weight: bold">Il n'y a pas assez de ressources avec
                    {{ task.skills|length > 1 ? 'les compétences' : 'la compétence' }}
                    {{ task.skills|join(', ', ' et ') }} pour subvenir aux besoins de cette tâche.</span><br/>
            </p>
            <p class="mb-0">12 ressources maximale requises et seulement 8 disponible.</p>
        </div>
    </div>
    {% endif %}
{% endblock %}